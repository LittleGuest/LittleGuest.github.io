<!DOCTYPE html>
<html lang="en"><head>
    <title>gopher9527&#39;s Blog</title>
    <meta content="text/html;charset=utf-8" http-equiv="Content-Type">
    <meta content="utf-8" http-equiv="encoding">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="format-detection" content="telephone=no" />
    <meta name="theme-color" content="#000084" />
    <link rel="icon" href="https://littleguest.github.io//favicon.ico">
    <link rel="canonical" href="https://littleguest.github.io/">
    
    
</head>
<body>
<nav class="navbar navbar-inverse navbar-fixed-top">
    <div class="navbar-inner">
        <div class="container">
            <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse"></button>
            <a class="brand" href="https://littleguest.github.io/">gopher9527&#39;s Blog</a>
            <div class="nav-collapse collapse">
                <ul class="nav">
                    
                    
                        
                            <li>
                                <a href="/about/">
                                    
                                    <span>About</span>
                                </a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/posts/">
                                    
                                    <span>Posts</span>
                                </a>
                            </li>
                        
                    
                        
                            <li>
                                <a href="/links/">
                                    
                                    <span>Links</span>
                                </a>
                            </li>
                        
                    
                </ul>
            </div>
        </div>
    </div>
</nav><div id="content" class="container">

<div class="row-fluid navmargin">
    <div class="page-header">
        <h1>使用Docker部署主从MySQL - Tue, Feb 23, 2021</h1>
    </div>
    <p class="lead">如何使用Docker部署主从MySQL</p>
    <h2 id="mysql-主从复制">MySQL 主从复制</h2>
<p><strong>下载 MySQL 镜像</strong></p>
<p>官方镜像的 MySQL 版本是8.x</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ docker pull mysql
</code></pre></div><p><strong>创建 MySQL 主从容器</strong></p>
<p>主</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ docker run -d --name mysql-master -p 13306:3306 -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span>root mysql
</code></pre></div><p>从</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ docker run -d --name mysql-slave -p 13307:3306 -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span>root mysql
</code></pre></div><p>分别用工具连接，测试能正常使用。</p>
<p><strong>配置</strong></p>
<ul>
<li>
<p>主库配置</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 进入主库容器</span>
$ docker exec -it mysql-master bash
<span style="color:#75715e"># 编辑MySQL配置</span>
$ vim /etc/mysql/my.cnf
</code></pre></div><p>添加如下内容</p>
<pre><code class="language-cnf" data-lang="cnf">[mysqld]
server-id = 1
log-bin = mysql-bin
</code></pre><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 退出容器并重启容器</span>
$ docker restart mysql-master
</code></pre></div><p>再次进入容器，在主库中创建数据同步用户 <code>slave</code> ，授予改用户 <code>REPLICATION SLAVE</code> 和 <code>REPLICATION CLIENT</code> 权限，用户在主从库之间同步数据。</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">mysql&gt; CREATE USER <span style="color:#e6db74">&#39;slave&#39;</span>@<span style="color:#e6db74">&#39;%&#39;</span> IDENTIFIED BY <span style="color:#e6db74">&#39;slave&#39;</span>;
mysql&gt; GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* TO <span style="color:#e6db74">&#39;slave&#39;</span>@<span style="color:#e6db74">&#39;%&#39;</span>;
</code></pre></div></li>
<li>
<p>从库配置</p>
<p>在同样的配置文件中添加如下配置</p>
<pre><code class="language-cnf" data-lang="cnf">[mysqld]
server-id = 2
log-bin = mysql-slave-bin
relay_log = mysql-slave-relay-bin
</code></pre></li>
<li>
<p>开启主从配置</p>
<p>在主客户端输入</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql">mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">show</span> master status;
<span style="color:#f92672">+------------------+----------+--------------+------------------+-------------------+</span>
<span style="color:#f92672">|</span> File             <span style="color:#f92672">|</span> Position <span style="color:#f92672">|</span> Binlog_Do_DB <span style="color:#f92672">|</span> Binlog_Ignore_DB <span style="color:#f92672">|</span> Executed_Gtid_Set <span style="color:#f92672">|</span>
<span style="color:#f92672">+------------------+----------+--------------+------------------+-------------------+</span>
<span style="color:#f92672">|</span> mysql<span style="color:#f92672">-</span>bin.<span style="color:#ae81ff">000001</span> <span style="color:#f92672">|</span>      <span style="color:#ae81ff">713</span> <span style="color:#f92672">|</span>              <span style="color:#f92672">|</span>                  <span style="color:#f92672">|</span>                   <span style="color:#f92672">|</span>
<span style="color:#f92672">+------------------+----------+--------------+------------------+-------------------+</span>
<span style="color:#ae81ff">1</span> row <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">00</span> sec)
</code></pre></div><p>在从客户端输入</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql">mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">change</span> master <span style="color:#66d9ef">to</span> master_host<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;172.17.0.2&#39;</span>, master_user<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;slave&#39;</span>, master_password<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;slave&#39;</span>, master_port<span style="color:#f92672">=</span><span style="color:#ae81ff">3306</span>, master_log_file<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;mysql-bin.000001&#39;</span>, master_log_pos<span style="color:#f92672">=</span><span style="color:#ae81ff">713</span>, master_connect_retry<span style="color:#f92672">=</span><span style="color:#ae81ff">30</span>;
</code></pre></div><p>命令说明</p>
<ul>
<li>master_host ：Master的地址，指的是容器的独立ip,可以通过 <code>docker inspect --format='{{.NetworkSettings.IPAddress}}' 容器名称|容器id</code> 查询容器的ip</li>
<li>master_port：Master的端口号，指的是容器的端口号</li>
<li>master_user：用于数据同步的用户</li>
<li>master_password：用于同步的用户的密码</li>
<li>master_log_file：指定 Slave 从哪个日志文件开始复制数据，即上文中提到的 File 字段的值</li>
<li>master_log_pos：从哪个 Position 开始读，即上文中提到的 Position 字段的值</li>
<li>master_connect_retry：如果连接失败，重试的时间间隔，单位是秒，默认是60秒</li>
</ul>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"> <span style="color:#75715e"># 查看主从同步状态
</span><span style="color:#75715e"></span> mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">show</span> slave status <span style="color:#960050;background-color:#1e0010">\</span>G;
 <span style="color:#f92672">***************************</span> <span style="color:#ae81ff">1</span>. row <span style="color:#f92672">***************************</span>
               Slave_IO_State: 
                   Master_Host: <span style="color:#ae81ff">172</span>.<span style="color:#ae81ff">17</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">2</span>
                   Master_User: slave
                   Master_Port: <span style="color:#ae81ff">3306</span>
                 Connect_Retry: <span style="color:#ae81ff">30</span>
               Master_Log_File: mysql<span style="color:#f92672">-</span>bin.<span style="color:#ae81ff">000001</span>
           Read_Master_Log_Pos: <span style="color:#ae81ff">713</span>
               Relay_Log_File: emysql<span style="color:#f92672">-</span>slave<span style="color:#f92672">-</span>relay<span style="color:#f92672">-</span>bin.<span style="color:#ae81ff">000001</span>
                 Relay_Log_Pos: <span style="color:#ae81ff">4</span>
         Relay_Master_Log_File: mysql<span style="color:#f92672">-</span>bin.<span style="color:#ae81ff">000001</span>
             Slave_IO_Running: No
             Slave_SQL_Running: No
               Replicate_Do_DB: 
           Replicate_Ignore_DB: 
           Replicate_Do_Table: 
       Replicate_Ignore_Table: 
       Replicate_Wild_Do_Table: 
   Replicate_Wild_Ignore_Table: 
                   Last_Errno: <span style="color:#ae81ff">0</span>
                   Last_Error: 
                 Skip_Counter: <span style="color:#ae81ff">0</span>
           Exec_Master_Log_Pos: <span style="color:#ae81ff">713</span>
               Relay_Log_Space: <span style="color:#ae81ff">156</span>
               Until_Condition: None
               Until_Log_File: 
                 Until_Log_Pos: <span style="color:#ae81ff">0</span>
           Master_SSL_Allowed: No
           Master_SSL_CA_File: 
           Master_SSL_CA_Path: 
               Master_SSL_Cert: 
             Master_SSL_Cipher: 
               Master_SSL_Key: 
         Seconds_Behind_Master: <span style="color:#66d9ef">NULL</span>
 Master_SSL_Verify_Server_Cert: No
                 Last_IO_Errno: <span style="color:#ae81ff">0</span>
                 Last_IO_Error: 
               Last_SQL_Errno: <span style="color:#ae81ff">0</span>
               Last_SQL_Error: 
   Replicate_Ignore_Server_Ids: 
             Master_Server_Id: <span style="color:#ae81ff">0</span>
                   Master_UUID: 
             Master_Info_File: mysql.slave_master_info
                     SQL_Delay: <span style="color:#ae81ff">0</span>
           SQL_Remaining_Delay: <span style="color:#66d9ef">NULL</span>
       Slave_SQL_Running_State: 
           Master_Retry_Count: <span style="color:#ae81ff">86400</span>
                   Master_Bind: 
       Last_IO_Error_Timestamp: 
     Last_SQL_Error_Timestamp: 
               Master_SSL_Crl: 
           Master_SSL_Crlpath: 
           Retrieved_Gtid_Set: 
             Executed_Gtid_Set: 
                 Auto_Position: <span style="color:#ae81ff">0</span>
         Replicate_Rewrite_DB: 
                 Channel_Name: 
           Master_TLS_Version: 
       Master_public_key_path: 
         Get_master_public_key: <span style="color:#ae81ff">0</span>
             Network_Namespace: 
 <span style="color:#ae81ff">1</span> row <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span>, <span style="color:#ae81ff">1</span> <span style="color:#a6e22e">warning</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">01</span> sec)

 ERROR: 
 No query specified
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#75715e"># 开启主从复制
</span><span style="color:#75715e"></span>mysql<span style="color:#f92672">&gt;</span> start slave;
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#75715e"># 再次查看状态
</span><span style="color:#75715e"></span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">show</span> slave status <span style="color:#960050;background-color:#1e0010">\</span>G;
<span style="color:#f92672">***************************</span> <span style="color:#ae81ff">1</span>. row <span style="color:#f92672">***************************</span>
              Slave_IO_State: Waiting <span style="color:#66d9ef">for</span> master <span style="color:#66d9ef">to</span> send event
                  Master_Host: <span style="color:#ae81ff">172</span>.<span style="color:#ae81ff">17</span>.<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">2</span>
                  Master_User: slave
                  Master_Port: <span style="color:#ae81ff">3306</span>
                Connect_Retry: <span style="color:#ae81ff">30</span>
              Master_Log_File: mysql<span style="color:#f92672">-</span>bin.<span style="color:#ae81ff">000001</span>
          Read_Master_Log_Pos: <span style="color:#ae81ff">1581</span>
              Relay_Log_File: emysql<span style="color:#f92672">-</span>slave<span style="color:#f92672">-</span>relay<span style="color:#f92672">-</span>bin.<span style="color:#ae81ff">000002</span>
                Relay_Log_Pos: <span style="color:#ae81ff">1192</span>
        Relay_Master_Log_File: mysql<span style="color:#f92672">-</span>bin.<span style="color:#ae81ff">000001</span>
            Slave_IO_Running: Yes
            Slave_SQL_Running: Yes
              Replicate_Do_DB: 
          Replicate_Ignore_DB: 
          Replicate_Do_Table: 
      Replicate_Ignore_Table: 
      Replicate_Wild_Do_Table: 
  Replicate_Wild_Ignore_Table: 
                  Last_Errno: <span style="color:#ae81ff">0</span>
                  Last_Error: 
                Skip_Counter: <span style="color:#ae81ff">0</span>
          Exec_Master_Log_Pos: <span style="color:#ae81ff">1581</span>
              Relay_Log_Space: <span style="color:#ae81ff">1408</span>
              Until_Condition: None
              Until_Log_File: 
                Until_Log_Pos: <span style="color:#ae81ff">0</span>
          Master_SSL_Allowed: No
          Master_SSL_CA_File: 
          Master_SSL_CA_Path: 
              Master_SSL_Cert: 
            Master_SSL_Cipher: 
              Master_SSL_Key: 
        Seconds_Behind_Master: <span style="color:#ae81ff">0</span>
Master_SSL_Verify_Server_Cert: No
                Last_IO_Errno: <span style="color:#ae81ff">0</span>
                Last_IO_Error: 
              Last_SQL_Errno: <span style="color:#ae81ff">0</span>
              Last_SQL_Error: 
  Replicate_Ignore_Server_Ids: 
            Master_Server_Id: <span style="color:#ae81ff">1</span>
                  Master_UUID: a9da6629<span style="color:#f92672">-</span><span style="color:#ae81ff">75</span>d6<span style="color:#f92672">-</span><span style="color:#ae81ff">11</span>eb<span style="color:#f92672">-</span><span style="color:#ae81ff">96</span>b3<span style="color:#f92672">-</span><span style="color:#ae81ff">0242</span>ac110002
            Master_Info_File: mysql.slave_master_info
                    SQL_Delay: <span style="color:#ae81ff">0</span>
          SQL_Remaining_Delay: <span style="color:#66d9ef">NULL</span>
      Slave_SQL_Running_State: Slave has <span style="color:#66d9ef">read</span> <span style="color:#66d9ef">all</span> relay log; waiting <span style="color:#66d9ef">for</span> more updates
          Master_Retry_Count: <span style="color:#ae81ff">86400</span>
                  Master_Bind: 
      Last_IO_Error_Timestamp: 
    Last_SQL_Error_Timestamp: 
              Master_SSL_Crl: 
          Master_SSL_Crlpath: 
          Retrieved_Gtid_Set: 
            Executed_Gtid_Set: 
                Auto_Position: <span style="color:#ae81ff">0</span>
        Replicate_Rewrite_DB: 
                Channel_Name: 
          Master_TLS_Version: 
      Master_public_key_path: 
        Get_master_public_key: <span style="color:#ae81ff">0</span>
            Network_Namespace: 
<span style="color:#ae81ff">1</span> row <span style="color:#66d9ef">in</span> <span style="color:#66d9ef">set</span>, <span style="color:#ae81ff">1</span> <span style="color:#a6e22e">warning</span> (<span style="color:#ae81ff">0</span>.<span style="color:#ae81ff">01</span> sec)

ERROR: 
No query specified
</code></pre></div><p>正常情况下，开启主从复制后 <code>Slave_IO_Running</code> 和 <code>Slave_SQL_Running</code> 都是 Yes。</p>
</li>
</ul>
<p><strong>测试</strong></p>
<p>在主库中</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#75715e"># 创建库
</span><span style="color:#75715e"></span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">create</span> <span style="color:#66d9ef">database</span> msr_test;

<span style="color:#75715e"># 在 msr_test 库中创建表
</span><span style="color:#75715e"></span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">CREATE</span> <span style="color:#66d9ef">TABLE</span> <span style="color:#f92672">`</span>sys_dict<span style="color:#f92672">`</span> (
  <span style="color:#f92672">`</span>id<span style="color:#f92672">`</span> <span style="color:#66d9ef">bigint</span> <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> <span style="color:#66d9ef">AUTO_INCREMENT</span> COMMENT <span style="color:#e6db74">&#39;ID&#39;</span>,
  <span style="color:#f92672">`</span>name<span style="color:#f92672">`</span> <span style="color:#66d9ef">varchar</span>(<span style="color:#ae81ff">255</span>) <span style="color:#66d9ef">NOT</span> <span style="color:#66d9ef">NULL</span> COMMENT <span style="color:#e6db74">&#39;字典名称&#39;</span>,
  <span style="color:#f92672">`</span>description<span style="color:#f92672">`</span> <span style="color:#66d9ef">varchar</span>(<span style="color:#ae81ff">255</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span> COMMENT <span style="color:#e6db74">&#39;描述&#39;</span>,
  <span style="color:#f92672">`</span>create_by<span style="color:#f92672">`</span> <span style="color:#66d9ef">varchar</span>(<span style="color:#ae81ff">255</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span> COMMENT <span style="color:#e6db74">&#39;创建者&#39;</span>,
  <span style="color:#f92672">`</span>update_by<span style="color:#f92672">`</span> <span style="color:#66d9ef">varchar</span>(<span style="color:#ae81ff">255</span>) <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span> COMMENT <span style="color:#e6db74">&#39;更新者&#39;</span>,
  <span style="color:#f92672">`</span>create_time<span style="color:#f92672">`</span> <span style="color:#66d9ef">datetime</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span> COMMENT <span style="color:#e6db74">&#39;创建日期&#39;</span>,
  <span style="color:#f92672">`</span>update_time<span style="color:#f92672">`</span> <span style="color:#66d9ef">datetime</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">NULL</span> COMMENT <span style="color:#e6db74">&#39;更新时间&#39;</span>,
  <span style="color:#66d9ef">PRIMARY</span> <span style="color:#66d9ef">KEY</span> (<span style="color:#f92672">`</span>id<span style="color:#f92672">`</span>) <span style="color:#66d9ef">USING</span> BTREE
) <span style="color:#66d9ef">ENGINE</span><span style="color:#f92672">=</span>InnoDB <span style="color:#66d9ef">AUTO_INCREMENT</span><span style="color:#f92672">=</span><span style="color:#ae81ff">15</span> <span style="color:#66d9ef">DEFAULT</span> <span style="color:#66d9ef">CHARSET</span><span style="color:#f92672">=</span>utf8 ROW_FORMAT<span style="color:#f92672">=</span>COMPACT COMMENT<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;数据字典&#39;</span>;

<span style="color:#75715e"># 在表中插入数据
</span><span style="color:#75715e"></span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">INSERT</span> <span style="color:#66d9ef">INTO</span> msr_test.<span style="color:#a6e22e">sys_dict</span> (name,description,create_by,update_by,create_time,update_time) <span style="color:#66d9ef">VALUES</span>
	 (<span style="color:#e6db74">&#39;user_status&#39;</span>,<span style="color:#e6db74">&#39;用户状态&#39;</span>,<span style="color:#66d9ef">NULL</span>,<span style="color:#66d9ef">NULL</span>,<span style="color:#e6db74">&#39;2019-10-27 20:31:36.0&#39;</span>,<span style="color:#66d9ef">NULL</span>),
	 (<span style="color:#e6db74">&#39;dept_status&#39;</span>,<span style="color:#e6db74">&#39;部门状态&#39;</span>,<span style="color:#66d9ef">NULL</span>,<span style="color:#66d9ef">NULL</span>,<span style="color:#e6db74">&#39;2019-10-27 20:31:36.0&#39;</span>,<span style="color:#66d9ef">NULL</span>),
	 (<span style="color:#e6db74">&#39;job_status&#39;</span>,<span style="color:#e6db74">&#39;岗位状态&#39;</span>,<span style="color:#66d9ef">NULL</span>,<span style="color:#66d9ef">NULL</span>,<span style="color:#e6db74">&#39;2019-10-27 20:31:36.0&#39;</span>,<span style="color:#66d9ef">NULL</span>);
</code></pre></div><p>在从库中</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-mysql" data-lang="mysql"><span style="color:#75715e"># 查看库
</span><span style="color:#75715e"></span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">show</span> <span style="color:#66d9ef">databases</span>;
<span style="color:#f92672">+--------------------+</span>
<span style="color:#f92672">|</span> <span style="color:#66d9ef">Database</span>           <span style="color:#f92672">|</span>
<span style="color:#f92672">+--------------------+</span>
<span style="color:#f92672">|</span> information_schema <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> msr_test           <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> mysql              <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> performance_schema <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> sys                <span style="color:#f92672">|</span>
<span style="color:#f92672">+--------------------+</span>

<span style="color:#75715e"># 查看表数据
</span><span style="color:#75715e"></span>mysql<span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">select</span> <span style="color:#f92672">*</span> <span style="color:#66d9ef">from</span> msr_test.sys_dict;
<span style="color:#f92672">+----+-------------+-------------+-----------+-----------+---------------------+-------------+</span>
<span style="color:#f92672">|</span> id <span style="color:#f92672">|</span> name        <span style="color:#f92672">|</span> description <span style="color:#f92672">|</span> create_by <span style="color:#f92672">|</span> update_by <span style="color:#f92672">|</span> create_time         <span style="color:#f92672">|</span> update_time <span style="color:#f92672">|</span>
<span style="color:#f92672">+----+-------------+-------------+-----------+-----------+---------------------+-------------+</span>
<span style="color:#f92672">|</span> <span style="color:#ae81ff">15</span> <span style="color:#f92672">|</span> user_status <span style="color:#f92672">|</span>             <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>      <span style="color:#f92672">|</span> <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">27</span> <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">31</span>:<span style="color:#ae81ff">36</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>        <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> <span style="color:#ae81ff">16</span> <span style="color:#f92672">|</span> dept_status <span style="color:#f92672">|</span>             <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>      <span style="color:#f92672">|</span> <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">27</span> <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">31</span>:<span style="color:#ae81ff">36</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>        <span style="color:#f92672">|</span>
<span style="color:#f92672">|</span> <span style="color:#ae81ff">17</span> <span style="color:#f92672">|</span> job_status  <span style="color:#f92672">|</span>             <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>      <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>      <span style="color:#f92672">|</span> <span style="color:#ae81ff">2019</span><span style="color:#f92672">-</span><span style="color:#ae81ff">10</span><span style="color:#f92672">-</span><span style="color:#ae81ff">27</span> <span style="color:#ae81ff">20</span>:<span style="color:#ae81ff">31</span>:<span style="color:#ae81ff">36</span> <span style="color:#f92672">|</span> <span style="color:#66d9ef">NULL</span>        <span style="color:#f92672">|</span>
<span style="color:#f92672">+----+-------------+-------------+-----------+-----------+---------------------+-------------+</span>
</code></pre></div><p>说明MySQL主从复制是部署成功了的。</p>
<p><strong>最后</strong></p>
<p>因为容器每次启动的时候ip会变化，所以都会给个固定的ip</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 查看docker占用的网段</span>
$ ifconfig
br-ab794da606af: flags<span style="color:#f92672">=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span style="color:#ae81ff">1500</span>
        inet 172.18.0.1  netmask 255.255.0.0  broadcast 172.18.255.255
        ether 02:42:35:06:cc:a4  txqueuelen <span style="color:#ae81ff">0</span>  <span style="color:#f92672">(</span>Ethernet<span style="color:#f92672">)</span>
        RX packets <span style="color:#ae81ff">0</span>  bytes <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>0.0 B<span style="color:#f92672">)</span>
        RX errors <span style="color:#ae81ff">0</span>  dropped <span style="color:#ae81ff">0</span>  overruns <span style="color:#ae81ff">0</span>  frame <span style="color:#ae81ff">0</span>
        TX packets <span style="color:#ae81ff">0</span>  bytes <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>0.0 B<span style="color:#f92672">)</span>
        TX errors <span style="color:#ae81ff">0</span>  dropped <span style="color:#ae81ff">0</span> overruns <span style="color:#ae81ff">0</span>  carrier <span style="color:#ae81ff">0</span>  collisions <span style="color:#ae81ff">0</span>

docker0: flags<span style="color:#f92672">=</span>4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu <span style="color:#ae81ff">1500</span>
        inet 172.17.0.1  netmask 255.255.0.0  broadcast 172.17.255.255
        ether 02:42:b4:c0:2d:85  txqueuelen <span style="color:#ae81ff">0</span>  <span style="color:#f92672">(</span>Ethernet<span style="color:#f92672">)</span>
        RX packets <span style="color:#ae81ff">0</span>  bytes <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>0.0 B<span style="color:#f92672">)</span>
        RX errors <span style="color:#ae81ff">0</span>  dropped <span style="color:#ae81ff">0</span>  overruns <span style="color:#ae81ff">0</span>  frame <span style="color:#ae81ff">0</span>
        TX packets <span style="color:#ae81ff">0</span>  bytes <span style="color:#ae81ff">0</span> <span style="color:#f92672">(</span>0.0 B<span style="color:#f92672">)</span>
        TX errors <span style="color:#ae81ff">0</span>  dropped <span style="color:#ae81ff">0</span> overruns <span style="color:#ae81ff">0</span>  carrier <span style="color:#ae81ff">0</span>  collisions <span style="color:#ae81ff">0</span>
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 创建自定义网络</span>
$ docker network create --subnet 172.19.0.0/24 mysql-master-slave
</code></pre></div><div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 创建容器时指定ip</span>
$ docker run -d --name mysql-master-n --network mysql-master-slave --ip 172.19.0.2 -p 13306:3306 -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span>root mysql

$ docker run -d --name mysql-slave-n --network mysql-master-slave --ip 172.19.0.3 -p 13307:3306 -e MYSQL_ROOT_PASSWORD<span style="color:#f92672">=</span>root mysql
</code></pre></div><p>参考 <a href="https://juejin.cn/post/6907112721532059662">https://juejin.cn/post/6907112721532059662</a></p>

    <h4><a href="https://littleguest.github.io/">Back to Home</a></h4>
</div>


        </div><footer class="container">
    <hr class="soften">
    <p>

&copy; 

    gopher9527

<span id="thisyear">2020</span>

</p>
    <p class="text-center">
        
        
        
        <a href="https://github.com/LittleGuest">GitHub</a> 
        
    </p>
</footer>

</body><link rel="stylesheet" href="/css/bootstrap.css">
<link rel="stylesheet" href="/css/bootstrap-responsive.css">
<link rel="stylesheet" href="/css/style.css">

<script src="/js/jquery.js"></script>
<script src="/js/bootstrap-386.js"></script>
<script src="/js/bootstrap-transition.js"></script>
<script src="/js/bootstrap-alert.js"></script>
<script src="/js/bootstrap-modal.js"></script>
<script src="/js/bootstrap-dropdown.js"></script>
<script src="/js/bootstrap-scrollspy.js"></script>
<script src="/js/bootstrap-tab.js"></script>
<script src="/js/bootstrap-tooltip.js"></script>
<script src="/js/bootstrap-popover.js"></script>
<script src="/js/bootstrap-button.js"></script>
<script src="/js/bootstrap-collapse.js"></script>
<script src="/js/bootstrap-carousel.js"></script>
<script src="/js/bootstrap-typeahead.js"></script>
<script src="/js/bootstrap-affix.js"></script>
<script>
    _386 = { 
        fastLoad: false ,
        onePass: false , 
        speedFactor: 1 
    };

    
    function ThisYear() {
        document.getElementById('thisyear').innerHTML = new Date().getFullYear();
    };
</script></html>
